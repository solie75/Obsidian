<존슨 알고리즘>

벨만-포드 알고리즘과 다익스트라 알고리즘의 방법을 결합하여 <span style="color:yellow ">모든 정점 사이의 최단 경로를 구하는 알고리즘</span>.
다익스트라 알고리즘의 효율성을 활요함과 동시에 <span style="color:yellow">음수 가중치</span>를 갖는 그래프에 대해서도 올바른 결과를 생성할 수 있다.
상당히 새로운 접근 방법을 사용한다.
- 음수 가중치에 대한 다익스트라 알고리즘의 한계를 극복하기 위해 <span style="color: yellow">전체 엣지 가중치를 음수가 아닌 형태로 변환</span>했다.
	- 벨만-포드 알고리즘과 적절한 수학 논리를 결합하여 이루어졌다.

## 동작 방식

- 그래프에 새로운 더미(Dummy)정점을 추가한다.
	- 그리고 이 더미 정점과 나머지 모든 정점 사이에 가중치가 0인 엣지를 연결한다.
- 이후 벨만-포드 알고리즘을 이용하여 더미 장점과 나머지 정점들 사이의 최단 경로를 찾고, 나중에 사용하기 위해 각 정점까지의 최단 거리를 기록한다.

## 더미 정점 추가

- 더미 정점과 나머지 모든 정점 사리에 가중치가 0인 엣지를 연결했기 때문에 <span style="color: yellow">모든 최단거리 값은 0보다 클 수는 없다.</span>
- 또한 그래프의 모든 정점에 대한 연결을 통해 거리 값이 모든 가능한 순회 경로에서 일정한 관계를 유지할 수 있다.
	- 엣지 가중치와 최단 거리의 합 연산이 간단해질 수 있다.
		- 이동 경로상의 연속한 정점에 대해서 거리 값 연산이 서로 상쇄되어, 결국 **전체 합** 은 첫 번째 정점과 마지막 정점의 거리 값 차와 같다.
- ex. 음수 가중치가 있는 그래프 (  A 부터 E 까지의 정점이 있는 그래프에 더미 정점 s 를 추가한 형태)
	1. 검은색 엣지 옆 괄호에 적힌 숫자 : 엣지 가중치
	2. 정점 아래 빨간색 글자 : S 에서 각 정점까지의 최단 경로와 최단 거리
	3. 빨간색 실선 화살표 : S로부터 출발하는 최단 경로
	4. 점선 화살표 : 최단 경로에서 사용되지 않은 가중치가 0인 엣지

![[Pasted image 20221230155422.png]]

그래프에서 A -> B -> C -> A -> D -> E 순서로 탐색할 경우, 각 정점의 최단 거리

![[Pasted image 20221230155524.png]]

각 정점의 거리 사이에 초기 엣지 가중치를 추가하면 다음과 같다.

![[Pasted image 20221230155548.png]]

- 각 엣지 가중치에 다음 수식을 적용한다.
	- w(uv) : 정점 u와 v 사이의 초기 엣지 가중치
	- d[s, u] : s 정점과 u 정점 사이의 최단 경로 거리
	- d[s, v] : s 정점과 v 정점 사이의 최단 경로 거리
	- w(uv) : 변환된 엣지 가중치
- W(uv) = w(uv) + d[s, u] - d[s, v]
- 위의 수식을 실제로 적용한 결과는 다음과 같다.
![[Pasted image 20221230155836.png]]

- 위 수식을 연속적으로 적용할 경우, <span style="color: yellow">각 줄의 세 번째 항</span>은 <span style="color: yellow">다음 줄의 가운데항</span>에 의해 상쇄되는 것을 발견할 수 있다.
	- 이를 <span style="color: yellow ">망원</span>(Telescoping) 속성이라 한다.
		- 수학 용어 중 **망원 급수(Telescoping Series)** 와 관련된 단어
		- 길이 조절이 되는 옛날 망원경 처럼 덧셈항과 뺄셈항이 서로 상쇄되어 수식이 짧아진다는 의미
- 이 속성으로 인해 A 정점에서  E 정점까지의 최소 거리를 나타내는 다음 두식은 관전히 갔다.
	- (w(AB) + d[s, A] - d[s, B]) +(w(BC) + d[s, B] - d[s, C]) + ... + (w(DE) +d{s, D} - d[s, E])
	- (w(AB) + w(BC) + w(CA) + w(AD) + w(DE) ) + d[s, A] +d[s, E]
- **즉 , 두 정점 사이를 연결하는 경로에 더해지는 값은 어느 경로를 선택하든 항상 같다.**
- 벨만-포드 알고리즘이 반환하는 거리 배열 d 에 대해, 항상 d[s, u] + wieght(u, v) >= d[s, v] 조건을 만족하기 때문에 변환된 가중치는 음수가 될 수 없다.
	- w(u, v) + d[s, u] - d[s, v] 값은 무조건 0보다 같거나 큰 수 이다.
- 이러한 가중치 변환 수식을 이용하면, 그래프에서 모든 최단 경로산에 존재하는 엣지의 가중치가 0으로 변경된다.
	- 원래의 최단 경로 순서는 그대로 유지한 채, 음이 아닌 가중치로 구성된 그래프가 만들어진다.
	- 이제 새로운 가중치를 갖는 그래프의 각 정점에서 다익스트라 알고리즘을 적용하여 모든 정점 쌍 사이의 최단 거리를 구할 수 있다.



- https://starrykss.tistory.com/1522