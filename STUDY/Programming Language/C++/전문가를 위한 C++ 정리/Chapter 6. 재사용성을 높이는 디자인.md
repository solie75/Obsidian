코드를 디자인 할 때는 자신을 포함하여 다른 프로그래머도 사용할 수 있게 만들어야 한다.

항상 한번만 만들고 여러번 사용한다는 사고방식을 갖도록 하자.
그 이유는 
1. 코드가 하나의 프로그램에서만 이용되는 경우가 드물다.
2. 작성되는 코드는 항상 팀 내 다른 프로그래머가 이용할 수 있어야 한다.
3. 재사용성이 낮으면 중복 코드가 발생하게 디고 유지보수 비용이 높아진다.
4. 무엇보다 자신의 업무에 가장 먼저 도움이 된다. : 이러한 재사용성이 높은 코드가 누적될 수록 여러 기능을 바로 사용할 수 있기 때문이다.

- 재사용성이 높은 코드를 디자인 하는 방법
  1. 다른 분야의 애플리케이션이나 조금 다른 사용 시나리오에서도 무리없이 적용할 수 있도록 기능이 충분히 일반화되어 있어야 한다.
  2. 재사용 성이 높은 코드는 언제나 사용하기 쉬워야 한다. 
  3. 가장 중요한 것은 추상화이다. 구현과 인터페이스의 분리가 잘 이루어 져야 한다.
    3. 1. 먼저 코드를 적절하게 구조화 한다. (클래스 계층 설계, 템플릿 사용 여부, 코드의 서브시스템 분리)
    3. 2. 그 다음 인터페이스를 디자인한다. 

- 추상화의 활용
추상화 원칙을 따르기 위해서는 내부의 상세 구혀이 드러나지 않도록 인터페이스를 만들어야 한다.
즉, 업그레이드나 버그 수정이 필요할 때 고객에게 인터페이스 사용 코드를 수정하라고 부담스러운 요청을 하지 않아도 된다.
인터페이스와 구현을 명확히 구분하면, 라이브러리가 의도하지 않은 방식으로 이용되는 것도 막을 수 있기 때문에, 예상하지 못한 동작을 하거나 오류가 발생하는 것도 피할 수 있다.
어떤 라이브러리는 클라이언트 코드로 하여금 특정 데이터를 유지하고 인터페이스 간에 주고 받을 수 있게 요구하기도 하는데 이러한 정보를 핸들 이라고 한다. 이 핸들은 함수 호출 간에 특정 인스턴스를 추적하고 기억하기 위한 목적으로 사용된다. 만약 라이브러리의 디자인이 핸들을 필요로 한다면 그 핸들의 내부 구조를 노출하지 않도록 해야 한다.
즉, 클라이언트로 하여금 핸들이 가진 내부 변수를 조작하도록 만들어서는 안 된다.

추상화는 다지안 과정에서 이루어지는 작은 결정마다 추상화 원칙을 만족하는지 되물어보아야 한다. 스스로를 사용자 입장에 두고 인터페이스 각각에 대해 그것을 이용할 때 내부 구조를 알아야 하도록 만들지 않았는지 생각해 봐야 한다.

- 관련석이 없거나 논리적으로 분리된 개념이 합쳐지지 않게 한다.
라이브러리나 프레임워크를 디자인 할 때는 하나의 작업 목표 또는 관련된 작업 목표 그룸에만 집중하고, 관계없는 개념들을 합쳐 놓아서는 안된다( 이를 응집성을 높인다 라고 한다.)

- 프로그램의 논리적 서브 시스템으로 분할한다.
서스베스템을 개별적인 컴포넌트로 디자인하여 독립적으로 재사용 가능하게 한다(보통 종속성을 낮춘다 라고 한다.)
각 서브시스템에 추상화 원칙을 적용해야 한다.

- 클래스 계층을 활용하여 논리적 개념을 분리한다.
서로 상관없는 개념들이 클래스 수준에서 서로 섞이는 것을 피해야 한다. 메서드 수준에서도 상관없는 개념이 섞이지 않도록 해야한다. 예를 들어 메서드 하나에 변경(set) 작업과 검사(get) 작업을 섞으면 안된다.

- 템플릿을 이용한 범용 데이터 구조와 알고리즘
템플릿 이라는 개념을 통해 내부에서 사용되는 데이터 타입이나 클래스에 독립적으로 적용할 수 있는 범용적인 코드 패턴을 만들 수 있다.
템플릿은 사전적 의미대로 코드 형판을 의미하는 것으로 코드가 적용될 데이터 타입을 파라미터로 넘겨줌으로써 코드를 재작성하지 않고도 여러 데이터 타입에 대한 작업을 수행할 수 있다.

가능하다면 데이터 구조와 알고리즘을 특정 프로그램의 이용 환경에 종속적으로 만들기 보다는 어디든 사용할 수 있게 범용적으로 만드는 것이 좋다.

- 템플릿이 다른 범용화 테크닉 보다 나은 이유
c 와 c++ 에서는 타입 지정 없이 void* 포인터를 이용해서 데이터 타입을 신경쓰지 않고 코드를 작성할 수 있지만 사용자는 데이터 타입을 void* 로 캐스팅해서 범용 코드를 사용할 수 없다. 이러한 방법은 타입 세이프 하지 않다. 즉, 데이터를 이용하거나 저장할 때 그 타입이 목적하는 것과 같은지 검사할 방법이 없다는 뜻이다.
또 다른 방법은 공통의 상위 클래스를 두는 것이다. 다형성을 활용하여 특정 클래스의 파생 클래스 라면 해당 데이터 구조를 이용할 수 있게 한다. 하지만 이도 타입 세이프 하다고 할 수 없다. 컨테이너에서 객체를 꺼내 쓰려면 그 객체가 어떤 파생 클래스 타입을 가졌는지 기억했다가 해당 타입으로 다운 캐스팅 해야 한다.

- 템플릿 문제점
템플릿은 한 데이터 구조에 한 타입의 객체만 저장할 수 있고, 여러 데이터 타입을 동시에 적용하기 어렵다. 이러한 제약은 타입 세이프한 템플릿의 특징 때문으로, 타입 세이프가 중요하기는 하지만 어떤 사용 케이스에는 심각한 제약이 되기도 한다. 

- 템플리과 상속 비교
템플릿과 상속 중에 무엇을 이용해야 할지 결정하는 것이 어려울 때 다음을 기준으로 고려한다.
1. 서로 다른 타입에 대해 같은 기능을 제공하길 원한다면 템플릿이 유리하다. 즉, 데이터 구조나 알고리즘이 모든 타입을 같은 방식으로 취급한다면 템플릿화 하는 것이 좋다. 
2. 타입에 따라서 서로 다른 동작을 해야 한다면 상속을 이용한다. 예를 들어 큐와 우선순위 큐 같이 두 개의 서로 비슷하지만 다른 행태를 보이는 컨테이너를 만드러야 한다면 상속을 이용한다.
3. 템플릿과 상속을 함께 이용하는 경우 : 템플릿 큐 를 만들어서 어느 타입이나 저장할 수 있게 하면서 그 템플릿 큐를 상속 받아 템플릿화된 우선순위 큐를 만들 수 있다.

요약

재사용 코드를 디자인할 때는 추상화를 통해 코드를 적절히 구조화하고 좋은 인터페이스를 만들어야 한다.
- 코드를 구조화 하는 팁
  1. 관련이 없거나 논리적으로 분리된 개념이 합쳐지는 것을 피한다.
  2. 템플릿을 통해 범용 데이터 구조와 알고리즘을 만든다.
  3. 오류 검사와 안전 장치를 적절하게 제공한다.

- 인터페이스 디자인
  1. 사용하기 쉽게 한다.
  2. 필요한 기능을 빠뜨리지 않는다.
  3. 어수선하지 않고 간결하게 한다.
  4. 문자와 주석을 제공한다.
  5. 같은 기능을 수행하는데 여러가지 방법을 제공한다.
  6. 커스터마이즈를 지원한다.

- 범용성과 사용성을 조화 시키는 방법
  1. 복수의 인터페이스를 지원한다.
  2. 자주 사용되는 기능을 쓸 수 있게 한다.

