rasterization stage 는 3D 그래픽의 실시간 diaplaying을 목적으로 vector 정보(shapes 또는 primitives 로 구성된)를 raster image (픽셀로 구성된) 로 변환한다. 

<span style="color: yellow">rasterization 중에 각 primitive 는 pixel로 변환되며 각 primitive 의 정점당 값을 보간한다.</span>  rasterization 은 view frustum 에 대한 정점을 클리핑하는 것, 원근법(perspective)을 제공하기 위해 z 로 나누는 것을 수행하는 것, 2D viewport 에 대한 primitives 의 매핑(mapping)하는 것 그리고 pixel shader 를 작동시킬 방법 을 포함한다. pixel shader 를 사용하는 것은 선택적이지만  rasterizer stage 는 언제나 clipping, 점을 균일한 공간으로 변환하기 위한 원근분할(perspective divide to transform) 을 수행하고 정점을 뷰포트에 매핑한다.

rasterizer stage 에 입력되는 정점(x,y,z,w)은 homogeneous clip-space에 있다고 가정된다. 이 좌표 공간에서 x 는 오른쪽을, y 는 위쪽을, z 는 카메라 반대쪽을 가리킨다.

pipeline 에 pixel shader 가 없다고 알리고 depth 와 stencil 테스팅을 불가능하게 함으로써  rasterization 을 비활성화 할 수 있다. (set the pixel shader stage to NULL with ID3D11DeviceContext::PSSetShader), (set DepthEnable and StencilEnable to FALSE in D3D11_DEPTH_STENCIL_DESC).
비활성화 동안에, rasterization 에 관련된 pipeline counter 는 업데이트 되지 않는다. 

계층적 z 버퍼 최적화를 향사아시키는 하드웨어에서, depth 와 stencil 을 활서와 하는 동안 pixel shader stage 를 NULL 로 설정함으로서 z 버퍼를 미리 로드 할 수 있다.


## Getting started with the Rasterizer Stage

이 섹션에서는 viewport, scissors rectangle, rasterizer state, multi-sampling 을 설정하는 것을 설명한다.

### Set the Viewport

viewport 는 정점의 위치(clip space 내의) 를 render target position 에 매핑한다. 이 과정은 3D position 을 2D position 으로 크기 조절을 한다. render target은 y축이 아래를 향하도록 방향이 정해진다. 이것은 viewport 가 크기 조정되는 동안 y 좌표는 반전되어야 한다. 게다가 x와 y 의 크기는 다음의 형식에 따라 viewport 크기에 맞게 조정될 것이다. 
```c++
X = (X + 1) * Viewport.Width * 0.5 + Viewport.TopLeftX
Y = (1 - Y) * Viewport.Height * 0.5 + Viewport.TopLeftY
Z = Viewport.MinDepth + Z * (Viewport.MaxDepth - Viewport.MinDepth)
```

 D3D11_VIEWPORT 를 사용하고 ID3D11DeviceContext::RSSetViewports를 호출하는 것으로 640x 480viewport 를 생성했다.
```c++
D3D11_VIEWPORT vp[1];
    vp[0].Width = 640.0f;
    vp[0].Height = 480.0f;
    vp[0].MinDepth = 0;
    vp[0].MaxDepth = 1;
    vp[0].TopLeftX = 0;
    vp[0].TopLeftY = 0;
    g_pd3dContext->RSSetViewports( 1, vp );
```

viewport 설명(description)은 viewport 의 크기, depth를 매핑하기 위한 범위(MInDepth, MaxDepth 사용)과 viewport 상단 왼쪽의 위치를 특정한다. MinDepth 는 MaxDepth 의 이하여야 한다. MinDepth 와 MaxDepth 는 둘다 0.0 부터 1.0 사이여야 한다. 



뷰포트 설명은 뷰포트의 크기, 깊이를 매핑할 범위( _MinDepth_ 및 _MaxDepth_ 사용 ), 뷰포트의 왼쪽 상단 위치를 지정합니다. _MinDepth 는_ _MaxDepth_ 보다 작거나 같아야 합니다 . _MinDepth_ 및 _MaxDepth_ 의 범위 는 0.0에서 1.0 사이입니다. 뷰포트가 렌더링 대상에 매핑되는 것이 일반적이지만 반드시 필요한 것은 아닙니다. 또한 뷰포트는 렌더링 대상과 동일한 크기나 위치를 가질 필요가 없습니다.

뷰포트 배열을 만들 수 있지만 기하 도형 셰이더의 기본 출력에는 하나만 적용할 수 있습니다. 한 번에 하나의 뷰포트만 활성으로 설정할 수 있습니다. 파이프라인은 래스터화 중에 기본 뷰포트(및 다음 섹션에서 설명하는 가위 직사각형)를 사용합니다. 기본값은 항상 배열의 첫 번째 뷰포트(또는 가위 직사각형)입니다. 지오메트리 셰이더에서 뷰포트의 기본 선택을 수행하려면 GS 출력 서명 선언에서 적절한 GS 출력 구성 요소에 ViewportArrayIndex 시맨틱을 지정합니다.