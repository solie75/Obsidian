
### Definition

메쉬 모델링 데이터의 정밀도를 단계별로 조정하는 기술 (렌더링 속도와 질 사이의 타협 속에서 탄생한 기술)
시점 거리에 따라서 폴리곤 모델의 퀄리티를 변화시키는 방법.

### Reason of existence

우리가 사용하는 실시간 렌더링 기술은 Realtime(실시간)으로 화면에 캐릭터와 지형, 건물등을 그려야 하기 때문에 어느 정도 질을 떨어뜨리더라도 빠르게 렌더링 되는 것이 중요하다. 이럴 때 가능하면 질을 적게 떨어뜨리면서 속도도 빠른 렌더링 기술을 개발하는 과정에서 탄생한 기술

## Static LOD

여러개의 메시를 준비해 놓고, 게임 등에서 카메라와 물체간의 거리를 측정해서 카메라와 가까운 거리에 있는 물체는 정밀한 메시를 사용하고, 거리가 멀어질수록 낮은 단계의 메시를 사용하는 기법

- 특징 : 처음부터 메쉬의 정밀도가 정해져 있고, 이를 카메라와의 거리에 따라서 단계별로 바꿔치기하며 출력한다.
- 장점 : 연산이 간단하기 때문에 속도가 빠르다.
- 단점 : 여러 단계의 메시를 추가로 가지고 있어야 하기 때문에 매모리 낭비가 심하고, 거리에 따라 메시 단계가 급격하게 변하기 때문에 튀는 현상(popping : LOD 의 단계가 변하는 순간 객체의 부피와 각짐의 정도가 사용자가 느끼기에 부자연스럽게 느껴지는 현상) 이 발생

## Dynamic LOD

카메라와 물체의 거리에 따라서 실시간으로 메시의 정밀도를 변화시키는 기법, 일반적으로 메시 분할과 메시 간략화 기법으로 나뉨

- 장점 : 거리에 따라서 자연스럽게 LOD가 이루어지기 때문에 튀는 현산(popping)이 적고, 낭비 되는 메모리도 없다.
- 단점 : 메시 분할이나, 간략화에 추가 연산이 필욯기 때문에 속도가 느리다. 정점 계산을 동적으로 수행하기 때문에 레벨이 바뀌거나 정점데이터를 갱신해야할 때 Lock-Unlock을 자주해야 한다.
- LOD 계산 방법
	- 거리 기반 LOD : 시점 위치와 오브젝트의 거리를 이용해 단계 값을 구하는 방법으로, 구현이 간단하고 부하가 적으나 필요없는 부분이 세밀하게 보이거나 세밀하게 보여야 하는 부분이 단순하게 보일 수 있다. (<span style ="color:green">....왜?</span>)
	- 면적 기반 LOD : 오브젝트의 투영 면적에 따른 단계값을 구하는 것. 오브젝트가 화면 혹은 바운딩 박스에 투영된 면적을 통해 LOD 단계값을 구하는 방법. LOD 의 효울(자연스러움)은 좋으나 cpu 의 연산이 많다. (투영 면적이 달라질 때마다 계산을 다시해야 한다.)
- 메시 간략화 : 폴리곤의 수를 줄이는 방법으로, 폴리곤의 수를 줄일 때 모양을 최대한 유지한 상태에서 간략화할 기준을 세우고 간략화할 방법을 통해 폴리곤의 수를 제거한다. 간략화의 기준은 어느 폴리곤의 어느 꼭지점을 먼저 제거할 것인가 등이 있다.(간략화 방법으로는 점 제거(Vertexx Decimation), 점 합치기(Vertex Clustering), 면 줄이기(Edege Colapse)의 3가지 방법이 있다.)
- 메시 분할 : 1개의 폴리곤을 여러개의 폴리곤으로 분리하는 방법

## Crack(균열)

하나의 단일 메시 속에 여러 단계의 메시를 공존시켜야 하는데, 여러단계의 메시가 공존하기 때문에 서로 다른 단계의 메시와 메시간의 연결이 매끄럽지 못한 경우 발생.
![[Pasted image 20221217183314.png]]
<균열이 발생한 경우>

- 균열이 발생한 경우 땜질할 삼각형이 필요하다.
![[Pasted image 20221217183329.png]]
<경계 부분에 추가 삼각형을 끼워 넣어야 한다.>

- 이러한 뗌질 삼각형을 LOD단계가 달라지는 모든 노드에 적용하여 상하좌우 네 가지 방향으로 만들어 주어야 한다.
![[Pasted image 20221217183524.png]]
<상하 좌우 뗌질 삼각형 추가>

## Popping 현상

거리에 따라 폴리곤 수가 갑작스럽게 줄어들거나 늘어나면 그래픽이 튀어보이는 현상. 정적 LOD 사용시 급격한 레벨의 차이로 모양이 바뀌어 튀어보이는 현상을 말한다.

- 해결 : 낮은 레벨에서 높은 레벨로 갈 때 사라지는 버텍스의 위치값을 Level과 Level 차이에 대한 보간값 t 를 구해서 보간해 준다.
![[Pasted image 20221217190143.png]]

![[Pasted image 20221217190213.png]]

Level 0 (0, 0), (10,15), (20,5) 과 Level 1 (0, 0), (12, 2.5), (20.5) 로 구성된 직선이 있을 때, Level 1 에서 존재하지 않는 점 (10, 15)를 Level 1 에서의 가상의 점(10, 2.5)와 보간해야 한다.

현재 Level 이  0 이고 보간값이 0.5 라면
중간점은 (10, 15) + 0.5 x (10, 2.5) - (10, 15) = (10, 8.75) 가 된다. 

### 해결
- 정적 LOD 에서의 해결 : 실시간으로 데이터를 계산할 때 t 값을 구하고, 그에 따라 보간하여 data pool 에 넣어준다.
- 동적 LOD 에서의 해결 : ,...?

## Remarks
#### Directx11 부터 테셀레이션 기능을 gpu 에서 본격적으로 사용할 수 있게 되었기 때문에 gpu 가 LOD 를 처리해줘서 따로 구현하지 않아도 된다.

