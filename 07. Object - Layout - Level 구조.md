
지금까지는 CEngine 에서 CTest.h 를 직접적으로 시행했다면 이제부터는 object -> layout -> Level  의 과정을 거쳐 오브젝트를 출력하는 구조를 구축한다.

- Engine Library 에 <span style="color: yellow">04. Level 폴더 생성</span>
- 04. Level 폴더에 CLayer class 생성
	- CGameObject* 형 vector 를 맴버 변수 (m_vecObject) 로 선언
		- 이는 기존의 CEngine class 의 맴버 변수로 선언되어 있던 CGameObject* g_Obj 와 CGraphicsShader* g_pShader를 대신한다. 
	- LayerTIck(), LayerFinalTick(); LayerRender() 를 생성
	- CLevel::AddGameObject() 함수를 생성하여 전달받은 CGameObject* 형 인자를 m_vecObject 에 추가
	- ~CLayer() 에서 m_vcecObject 를 삭제해야 하는데 이에 대한 코드를 func.h 에서 정의한다.
		- 기존의 Safe_Del_Array() 와 마찬가지로 vector 에 대한 삭제 및 클리어 함수인 Safe_Del_Vec() 을 생성.
	- LayerTick(), LayerFinaltick(), LayerRender() 에서는 m_vecObject 의 모든 요소에 대해 각각 GameObjectTick(), GameObjectFinaltick(), GameObjectRender() 를 호출한다.

- 04. Level 폴더에 CEntity 를 상속받는 <span style="color: yellow">CLevel class 생성</span>
	- CLayer* 형 배열을 맴버 변수(m_arrLayer)로 선언
		- m_arrLayer 의 최대 크기를 define.h 에서 # defin MAX_LAYER 32 로 정의한다.
	- LevelTick(), LevelFinaltick(), LevelRender() 를 생성
	- AddGameObject() 함수를 생성하여 전달받은 CGameObject* 형 인자와 int 형 인자를 사용하여 m_arrLayer 의 원하는 Layer에 대한 CLayer::AddGameObject() 를 호출한다.
	- ~CLevel() 에서 Safe_Del_Array() 로 m_arrLayer 배열을 삭제한다.
	- CLevel() 에서 m_arrLayer의 모든 요소에 new CLayer 로 메모리를 할당한다.
	- LevelTick(), LevelFinaltick(), LevelRender() 에서는 m_arrLayer 의 모든 요소에 대해 각각 LayerTick(), LayerFinaltick(), LayerRender() 를 호출한다.

- 03. Manager 에 04. LevelMgr 폴더 추가 후 CLevelMgr class 생성
	- 여러 Level 중 현재 작용되고 있는 Level 에 대한 맴버 변수 (CLevel* m_pCurLevel) 선언
	- Init(), Tick(), Finaltick() 생성
	- LevelInit() 에서 
		- m_pCurLevel 에 new CLevel 로 메모리를 할당
		- 기존의 TestInit() 에 구현된 코드를 가져온다
			- CGameObject* 현 지역변수 (testGameObj) 와 CGraphicsShader* 형 지역변수 (testShader) 를 선언한다.
			- g_Obj 에 new CGameObject로 메모리를 할당하고 사용할 컴포넌트를 AddComponent() 호출하여 추가한다.
			- Ptr<Mesh.> 형으로 지역변수(testMesh)를 선언하고 testMesh 에 FindRes<CMesh.>(L"TestMesh"); 를 사용하여 Mesh resource  를 저장한다.
			- testShader에 new CGraphicsShader 로 메모리를 할당한다.
			- Ptr<CGraphicsShader.> 형으로 지역변수 (TestShader)에 FindRes<CGraphicsShader.>(L"TestShader") 를 사용하여 Shader resource 를 저장한다.
			- testGameObj->GetMeshRender()에 대해 SetMesh() 를 호출하여 testMesh 를 저장한다.
			- testShader->GetMeshRender()에 대해 SetShader() 를 호출하여 testShader 를 저장한다.
			- m_pCurLevel 에 대해 AddGameObject() 를 호출하여 testGameObj 를 저장한다.

```c++
m_pCurLevel->AddGameObject(testGameObject, 0);
// 인덱스 0 의 레이어에 testGameObject 추가
```

	- LevelMgrTick() 에서
		- m_pCurLevel 에 대해 LevelTick() 과 LevelFinaltick() 를 호출한다.
	- LevelMgrRender() 에서
		- m_pCurLevel 에 대해 LevelRender() 를 호출한다.
	- CEngine class 에서 Init(), Tick(), Render() 부분에서 Test 관련을 지우고 LevelMgrInit(), LevelMgrTick(), LevelMgrRender() 를 추가한다.

# 기타

- CTransform::ComponentFinaltick() 에서 호출하던 UpdateTransformData()를 CMechRender::BeginRenderingMesh() 에서 다음으로 호출한다.
```c++
GetOwnwer()->Gettransform()->UpdateTransformData();
```
이로 인해서 모든 object 의 Tick() 과 Finaltick() 이 호출된 이후 Render()과정에서 Transform 의 데이터가 업데이트 된다.